{% block primary %}
<link href="c3.min.css" rel="stylesheet">
<script src="/js/d3.min.js"></script>
<script src="/js/c3.min.js"></script>

<script>
const monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun",
                    "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
</script>

    {% for row in table %}
        <h3>{{ row.title }} </h3>

        <div id="chart_{{row.name}}"></div>
        <script>
            c3.generate({
                bindto: '#chart_{{row.name}}',
                data: {
                   x: 'x',
                   columns: [
                        {{ h.copy_and_merge(12, row, ['x']) | safe }},
                        {{ h.report_row('Broken records', row, 'broken') | safe }}
                    ]
                },
                axis : {
                    y: {
                        max: 100,
                        min: 0,
                        padding: {top:0, bottom:0}
                    },
                    x : {
                        type : 'timeseries',
                        tick: {
                            format: function (x) { return  monthNames[x.getMonth()] + " " + x.getFullYear(); }
                        }
                    }
                }
            });
        </script>
        <hr/>
    {% endfor %}

{% endblock %}